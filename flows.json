[{"id":"cc64dd72e548f89a","type":"tab","label":"Home Page","disabled":false,"info":"","env":[]},{"id":"24e1411905e488b9","type":"tab","label":"Settings Page","disabled":false,"info":"","env":[]},{"id":"7bef6a87fd115472","type":"tab","label":"UI Settings","disabled":false,"info":"","env":[]},{"id":"8c23be714302cd61","type":"ui_base","theme":{"name":"theme-light","lightTheme":{"default":"#0094CE","baseColor":"#09759f","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"},"themeState":{"base-color":{"default":"#0094CE","value":"#09759f","edited":true},"page-titlebar-backgroundColor":{"value":"#09759f","edited":false},"page-backgroundColor":{"value":"#fafafa","edited":false},"page-sidebar-backgroundColor":{"value":"#333333","edited":false},"group-textColor":{"value":"#0daae7","edited":false},"group-borderColor":{"value":"#ffffff","edited":false},"group-backgroundColor":{"value":"#ffffff","edited":false},"widget-textColor":{"value":"#111111","edited":false},"widget-backgroundColor":{"value":"#09759f","edited":false},"widget-borderColor":{"value":"#ffffff","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}},"angularTheme":{"primary":"indigo","accents":"blue","warn":"red","background":"grey","palette":"light"}},"site":{"name":"Node-RED Dashboard","hideToolbar":"false","allowSwipe":"false","lockMenu":"false","allowTempTheme":"true","dateFormat":"DD/MM/YYYY","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"2a4cccc1f2ec666f","type":"ui-base","name":"My Dashboard","path":"/dashboard","includeClientData":true,"acceptsClientConfig":["ui-notification","ui-control"],"showPathInSidebar":false,"showPageTitle":true,"navigationStyle":"default","titleBarStyle":"default"},{"id":"b8c087a030a40e88","type":"ui-theme","name":"Default Theme","colors":{"surface":"#13458c","primary":"#0095ff","bgPage":"#050505","groupBg":"#f8fcfa","groupOutline":"#e8eded"},"sizes":{"pagePadding":"12px","groupGap":"12px","groupBorderRadius":"4px","widgetGap":"12px"}},{"id":"91ca877ba92392b8","type":"ui-page","name":"Home","ui":"2a4cccc1f2ec666f","path":"/home","icon":"home","layout":"grid","theme":"b8c087a030a40e88","order":1,"className":"","visible":true,"disabled":false},{"id":"c880cc57dd566c40","type":"ui-page","name":"Settings","ui":"2a4cccc1f2ec666f","path":"/settings","icon":"home","layout":"grid","theme":"b8c087a030a40e88","order":2,"className":"","visible":true,"disabled":false},{"id":"608ec21444db933d","type":"ui-group","name":"Controls","page":"91ca877ba92392b8","width":"2","height":"1","order":2,"showTitle":true,"className":"my-custom-class","visible":"true","disabled":"false"},{"id":"65d2902c5e05e02c","type":"ui-group","name":"Anedya connection credentials","page":"c880cc57dd566c40","width":"3","height":"1","order":1,"showTitle":true,"className":"","visible":"true","disabled":"false"},{"id":"ad25646ff154522b","type":"ui-group","name":"Settings","page":"c880cc57dd566c40","width":"2","height":"1","order":2,"showTitle":true,"className":"","visible":"true","disabled":"false"},{"id":"0d68c2b1500af744","type":"ui_group","name":"Group 1","tab":"","order":1,"disp":true,"width":"6","collapse":false,"className":""},{"id":"4b9a82cd860d4d4f","type":"ui_spacer","z":"cc64dd72e548f89a","name":"spacer","group":"0d68c2b1500af744","order":1,"width":1,"height":1},{"id":"d62eb6f272bd1da6","type":"ui-group","name":"Current Temperature","page":"91ca877ba92392b8","width":"2","height":"1","order":3,"showTitle":true,"className":"my-custom-class","visible":"true","disabled":"false"},{"id":"74c256c6933f8b6f","type":"ui-group","name":"Temperature Chart","page":"91ca877ba92392b8","width":"6","height":"1","order":6,"showTitle":true,"className":"","visible":"true","disabled":"false"},{"id":"aedb0d75dc453f72","type":"ui-group","name":"Current Humidity","page":"91ca877ba92392b8","width":"2","height":"1","order":4,"showTitle":true,"className":"my-custom-class","visible":"true","disabled":"false"},{"id":"55fbfd637ade4285","type":"ui-group","name":"Humidity chart","page":"91ca877ba92392b8","width":"6","height":"1","order":7,"showTitle":true,"className":"","visible":"true","disabled":"false"},{"id":"cc9daaeac75086db","type":"ui-group","name":"Device Status","page":"91ca877ba92392b8","width":"2","height":"1","order":1,"showTitle":true,"className":"my-custom-class","visible":"true","disabled":"false"},{"id":"7da969187e283dbb","type":"ui-group","name":"Branding","page":"91ca877ba92392b8","width":"4","height":"1","order":5,"showTitle":false,"className":"","visible":"true","disabled":"false"},{"id":"30733624289f93a6","type":"inject","z":"cc64dd72e548f89a","name":"get_latest_data_payload","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"2","crontab":"","once":true,"onceDelay":"1","topic":"","payload":"{\"nodes\":[\"20deeee8-f8ae-11ee-9dd8-c3aa61afe2fb\"],\"variable\":\"temperature\"}","payloadType":"json","x":470,"y":720,"wires":[["1e87bd738548db3d","59c9683ac1cecc4b"]]},{"id":"f4e40cf92d36e6f0","type":"debug","z":"cc64dd72e548f89a","name":"debug 1","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1064.4447174072266,"y":627.8888788223267,"wires":[]},{"id":"59c9683ac1cecc4b","type":"http request","z":"cc64dd72e548f89a","name":"get_latest_data","method":"POST","ret":"txt","paytoqs":"ignore","url":"https://api.anedya.io/v1/data/latest","tls":"","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"","senderr":false,"headers":[{"keyType":"Authorization","keyValue":"","valueType":"other","valueValue":"Bearer c93b7fdbcb11a189e8f33a89d1bfa56f92836d5ed3c148ec9bf912f29a9abee5"},{"keyType":"Accept","keyValue":"","valueType":"application/json","valueValue":""}],"x":860,"y":720,"wires":[["f4e40cf92d36e6f0","fe87a67ec82f45a8"]]},{"id":"fe87a67ec82f45a8","type":"function","z":"cc64dd72e548f89a","name":"function 1","func":"let parsedData;\n\ntry {\n    parsedData = JSON.parse(msg.payload);  // Safely parse the JSON\n} catch (e) {\n    node.error(\"Failed to parse JSON: \" + e.message, msg);\n    return null;  // Stop processing if JSON parsing fails\n}\n\nif (parsedData.data && Array.isArray(parsedData.data) && parsedData.data.length > 0) {\n    const value = parsedData.data[0].value;\n    msg.payload = value;  // Convert the value to a string\n} else {\n    //node.error(\"parsedData.data is not an array or is empty\", msg);\n    return null;  // Stop processing if data is not valid\n}\n\nreturn msg;\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1064.4447174072266,"y":727.8888788223267,"wires":[["f6a975daf07485e8","8e9a4a6a9d353943","dce12d47baa079ca"]]},{"id":"dce12d47baa079ca","type":"debug","z":"cc64dd72e548f89a","name":"debug 2","active":false,"tosidebar":true,"console":true,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1310,"y":800,"wires":[]},{"id":"b74bc177fc5caf44","type":"inject","z":"cc64dd72e548f89a","name":"get_latest_data_payload","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"2","crontab":"","once":true,"onceDelay":"1","topic":"","payload":"{\"nodes\":[\"20deeee8-f8ae-11ee-9dd8-c3aa61afe2fb\"],\"variable\":\"humidity\"}","payloadType":"json","x":532.2222900390625,"y":1125.5555391311646,"wires":[["5ac3453baed4a0e7","c9d4c5a6e586d66f"]]},{"id":"2231d177f2971bea","type":"debug","z":"cc64dd72e548f89a","name":"debug 3","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1116.7778778076172,"y":1039.0000472068787,"wires":[]},{"id":"5ac3453baed4a0e7","type":"http request","z":"cc64dd72e548f89a","name":"get_latest_data","method":"POST","ret":"txt","paytoqs":"ignore","url":"https://api.anedya.io/v1/data/latest","tls":"","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"","senderr":false,"headers":[{"keyType":"Authorization","keyValue":"","valueType":"other","valueValue":"Bearer c93b7fdbcb11a189e8f33a89d1bfa56f92836d5ed3c148ec9bf912f29a9abee5"},{"keyType":"Accept","keyValue":"","valueType":"application/json","valueValue":""}],"x":896.7778778076172,"y":1119.0000472068787,"wires":[["2231d177f2971bea","6f4e0351336dd2cd"]]},{"id":"7179195eaf859061","type":"debug","z":"cc64dd72e548f89a","name":"debug 4","active":true,"tosidebar":true,"console":true,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1310,"y":1180,"wires":[]},{"id":"70684baa6b26ace2","type":"http request","z":"cc64dd72e548f89a","name":"Anedya Http Post","method":"POST","ret":"txt","paytoqs":"ignore","url":"https://api.anedya.io/v1/commands/send","tls":"","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"","senderr":false,"headers":[{"keyType":"Authorization","keyValue":"","valueType":"other","valueValue":"Bearer d090d91cad8ba83adea4c27461131b2fa96c293f0ed95527351a88481ddfa58c"},{"keyType":"Accept","keyValue":"","valueType":"application/json","valueValue":""}],"x":2170,"y":180,"wires":[[]]},{"id":"f6a975daf07485e8","type":"ui-chart","z":"cc64dd72e548f89a","group":"74c256c6933f8b6f","name":"Temperature chart 2.0","label":"","order":1,"chartType":"line","category":"topic","categoryType":"msg","xAxisLabel":"Time","xAxisProperty":"","xAxisPropertyType":"property","xAxisType":"time","xAxisFormat":"","xAxisFormatType":"auto","yAxisLabel":"Celsius (°C)","yAxisProperty":"","ymin":"","ymax":"","action":"append","stackSeries":false,"pointShape":"line","pointRadius":"2","showLegend":false,"removeOlder":"15","removeOlderUnit":"60","removeOlderPoints":"2000","colors":["#0095ff","#ff0000","#ff7f0e","#2ca02c","#a347e1","#d62728","#ff9896","#9467bd","#c5b0d5"],"textColor":["#666666"],"textColorDefault":true,"gridColor":["#e5e5e5"],"gridColorDefault":true,"width":"6","height":"5","className":"","x":1316.6669158935547,"y":739.9999847412109,"wires":[[]]},{"id":"8e9a4a6a9d353943","type":"ui-gauge","z":"cc64dd72e548f89a","name":"Temperature Gauge 2.0","group":"d62eb6f272bd1da6","order":1,"width":"2","height":"2","gtype":"gauge-half","gstyle":"needle","title":"","units":"°C","icon":"","prefix":"","suffix":"","segments":[{"from":"0","color":"#5cd65c"},{"from":"35","color":"#ffc800"},{"from":"70","color":"#ea5353"}],"min":0,"max":"100","sizeThickness":"16","sizeGap":"4","sizeKeyThickness":8,"styleRounded":true,"styleGlow":false,"className":"custom-gauge-css","x":1326.6669158935547,"y":679.9999847412109,"wires":[]},{"id":"4374941834cd5278","type":"ui-gauge","z":"cc64dd72e548f89a","name":"Humidity Gauge 2.0","group":"aedb0d75dc453f72","order":1,"width":"2","height":"2","gtype":"gauge-half","gstyle":"needle","title":"","units":"%","icon":"","prefix":"","suffix":"","segments":[{"from":"0","color":"#5cd65c"},{"from":"35","color":"#ffc800"},{"from":"70","color":"#252be4"}],"min":0,"max":"100","sizeThickness":16,"sizeGap":4,"sizeKeyThickness":8,"styleRounded":true,"styleGlow":false,"className":"custom-gauge-css","x":1340,"y":1100,"wires":[]},{"id":"542ee6e44901b351","type":"ui-chart","z":"cc64dd72e548f89a","group":"55fbfd637ade4285","name":"Humidity chart","label":"","order":1,"chartType":"line","category":"topic","categoryType":"msg","xAxisLabel":"Timestamp","xAxisProperty":"","xAxisPropertyType":"property","xAxisType":"time","xAxisFormat":"","xAxisFormatType":"auto","yAxisLabel":"percent (%)","yAxisProperty":"","ymin":"","ymax":"","action":"append","stackSeries":false,"pointShape":"line","pointRadius":"2","showLegend":false,"removeOlder":"15","removeOlderUnit":"60","removeOlderPoints":"2000","colors":["#0095ff","#ff0000","#ff7f0e","#2ca02c","#a347e1","#d62728","#ff9896","#9467bd","#c5b0d5"],"textColor":["#666666"],"textColorDefault":true,"gridColor":["#e5e5e5"],"gridColorDefault":true,"width":"6","height":"5","className":"","x":1334.4445114135742,"y":1141.1111788749695,"wires":[[]]},{"id":"d0dc83bc988f28d4","type":"ui-switch","z":"cc64dd72e548f89a","d":true,"name":"All 2.0","label":"All","group":"608ec21444db933d","order":3,"width":0,"height":0,"passthru":false,"topic":"topic","topicType":"msg","style":"","className":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":250,"y":180,"wires":[["eafae3fcce8eb99a"]]},{"id":"df81703518d125a0","type":"debug","z":"cc64dd72e548f89a","name":"debug 9","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":600,"y":180,"wires":[]},{"id":"eafae3fcce8eb99a","type":"function","z":"cc64dd72e548f89a","name":"function 3","func":"let currentEpochTime = Math.floor(Date.now() / 1000);\nlet future_24_hour_time_ms = (currentEpochTime + 86400) * 1000;\nlet button_state\nif (msg.payload){\n    button_state=\"on\"\n}else{\n    button_state=\"off\"\n}\nlet json_payload = {\n    \"nodeid\": \"20deeee8-f8ae-11ee-9dd8-c3aa61afe2fb\",\n    \"command\": \"bulb\",\n    \"data\": button_state,\n    \"type\": \"string\",\n    \"expiry\": future_24_hour_time_ms\n};\nmsg.payload = JSON.stringify(json_payload);\nreturn msg;\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":420,"y":180,"wires":[["df81703518d125a0"]]},{"id":"96f20efd1e708518","type":"ui-button","z":"cc64dd72e548f89a","group":"608ec21444db933d","name":"ALL-ON","label":"All ON","order":4,"width":"1","height":"1","emulateClick":false,"tooltip":"","color":"","bgcolor":"","className":"","icon":"","iconPosition":"left","payload":"true","payloadType":"bool","topic":"topic","topicType":"msg","buttonColor":"'green'","textColor":"","iconColor":"","x":1000,"y":320,"wires":[["bea6ac6d48e00268","ad94c98b4df40846","4adaf38a5b456694","9e25a35f4bccae43","a6ee086ccbece116","ead59d17cfacd9ba"]]},{"id":"bea6ac6d48e00268","type":"ui-switch","z":"cc64dd72e548f89a","name":"Light Switch 2.0","label":"Light ","group":"608ec21444db933d","order":1,"width":0,"height":0,"passthru":false,"topic":"topic","topicType":"msg","style":"","className":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":1280,"y":300,"wires":[["4adaf38a5b456694","a6ee086ccbece116"]]},{"id":"ad94c98b4df40846","type":"ui-switch","z":"cc64dd72e548f89a","name":"Fan Switch 2.0","label":"Fan ","group":"608ec21444db933d","order":2,"width":0,"height":0,"passthru":false,"topic":"topic","topicType":"msg","style":"","className":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":1280,"y":380,"wires":[["9e25a35f4bccae43","ead59d17cfacd9ba"]]},{"id":"4adaf38a5b456694","type":"function","z":"cc64dd72e548f89a","name":"function 4","func":"let currentEpochTime = Math.floor(Date.now() / 1000);\nlet future_24_hour_time_ms = (currentEpochTime + 86400) * 1000;\nlet button_state\nif (msg.payload){\n    button_state=\"on\"\n}else{\n    button_state=\"off\"\n}\nlet json_payload = {\n    \"nodeid\": \"20deeee8-f8ae-11ee-9dd8-c3aa61afe2fb\",\n    \"command\": \"Light\",\n    \"data\": button_state,\n    \"type\": \"string\",\n    \"expiry\": future_24_hour_time_ms\n};\nmsg.payload = JSON.stringify(json_payload);\nreturn msg;\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1460,"y":300,"wires":[["77d96584db78cbf4","a0f80171cf12c210"]]},{"id":"9e25a35f4bccae43","type":"function","z":"cc64dd72e548f89a","name":"function 5","func":"let currentEpochTime = Math.floor(Date.now() / 1000);\nlet future_24_hour_time_ms = (currentEpochTime + 86400) * 1000;\nlet button_state\nif (msg.payload){\n    button_state=\"on\"\n}else{\n    button_state=\"off\"\n}\nlet json_payload = {\n    \"nodeid\": \"20deeee8-f8ae-11ee-9dd8-c3aa61afe2fb\",\n    \"command\": \"fan\",\n    \"data\": button_state,\n    \"type\": \"string\",\n    \"expiry\": future_24_hour_time_ms\n};\nmsg.payload = JSON.stringify(json_payload);\nreturn msg;\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1460,"y":400,"wires":[["837b9de2b6cf6336","62e2ec4e9bc1b1b9"]]},{"id":"350c780bab8f24b9","type":"ui-button","z":"cc64dd72e548f89a","group":"608ec21444db933d","name":"ALL-OFF","label":"All OFF","order":5,"width":"1","height":"1","emulateClick":false,"tooltip":"","color":"","bgcolor":"","className":"","icon":"","iconPosition":"left","payload":"false","payloadType":"bool","topic":"topic","topicType":"msg","buttonColor":"'green'","textColor":"","iconColor":"","x":1000,"y":380,"wires":[["bea6ac6d48e00268","ad94c98b4df40846","4adaf38a5b456694","ead59d17cfacd9ba","a6ee086ccbece116","a5bd275360fc329d","9e25a35f4bccae43"]]},{"id":"77d96584db78cbf4","type":"debug","z":"cc64dd72e548f89a","name":"debug 7","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1609.555591583252,"y":314.11113154888153,"wires":[]},{"id":"a0f80171cf12c210","type":"http request","z":"cc64dd72e548f89a","name":"send_command","method":"POST","ret":"txt","paytoqs":"ignore","url":"https://api.anedya.io/v1/commands/send","tls":"","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"","senderr":false,"headers":[{"keyType":"Authorization","keyValue":"","valueType":"other","valueValue":"Bearer c93b7fdbcb11a189e8f33a89d1bfa56f92836d5ed3c148ec9bf912f29a9abee5"},{"keyType":"Accept","keyValue":"","valueType":"application/json","valueValue":""}],"x":1629.555591583252,"y":274.11113154888153,"wires":[["5cdedc1853ef804e"]]},{"id":"837b9de2b6cf6336","type":"http request","z":"cc64dd72e548f89a","name":"send_command","method":"POST","ret":"txt","paytoqs":"ignore","url":"https://api.anedya.io/v1/commands/send","tls":"","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"","senderr":false,"headers":[{"keyType":"Authorization","keyValue":"","valueType":"other","valueValue":"Bearer c93b7fdbcb11a189e8f33a89d1bfa56f92836d5ed3c148ec9bf912f29a9abee5"},{"keyType":"Accept","keyValue":"","valueType":"application/json","valueValue":""}],"x":1631.6666717529297,"y":376.99999809265137,"wires":[["5b2c40477b81de8e"]]},{"id":"62e2ec4e9bc1b1b9","type":"debug","z":"cc64dd72e548f89a","name":"debug 8","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1610.555591583252,"y":428.1111172437668,"wires":[]},{"id":"5cdedc1853ef804e","type":"debug","z":"cc64dd72e548f89a","name":"debug 5","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1870.6666717529297,"y":263.0000123977661,"wires":[]},{"id":"5b2c40477b81de8e","type":"debug","z":"cc64dd72e548f89a","name":"debug 6","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1872.7777519226074,"y":365.88887894153595,"wires":[]},{"id":"c1cc3cceb3fe9e59","type":"http request","z":"cc64dd72e548f89a","name":"[https] get key-value","method":"POST","ret":"txt","paytoqs":"ignore","url":"https://api.anedya.io/v1/valuestore/getValue","tls":"","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"","senderr":false,"headers":[{"keyType":"Authorization","keyValue":"","valueType":"other","valueValue":"Bearer c93b7fdbcb11a189e8f33a89d1bfa56f92836d5ed3c148ec9bf912f29a9abee5"},{"keyType":"Accept","keyValue":"","valueType":"application/json","valueValue":""}],"x":951.1110916137695,"y":243.3333282470703,"wires":[["862b5f4e2026532f"]]},{"id":"af91af683872a6f0","type":"inject","z":"cc64dd72e548f89a","name":"Sync Light state","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"2","crontab":"","once":true,"onceDelay":"1","topic":"","payload":"","payloadType":"date","x":515.5555648803711,"y":288.88890075683594,"wires":[["70fe308931fe8727"]]},{"id":"70fe308931fe8727","type":"template","z":"cc64dd72e548f89a","name":"light_payload","field":"payload","fieldType":"msg","format":"json","syntax":"mustache","template":"{\n  \"namespace\": {\n    \"scope\": \"node\",\n    \"id\": \"20deeee8-f8ae-11ee-9dd8-c3aa61afe2fb\"\n  },\n  \"key\": \"Light\"\n}","output":"json","x":595.5555648803711,"y":248.88890075683594,"wires":[["fd8e02c1b6f38f26"]]},{"id":"fd8e02c1b6f38f26","type":"json","z":"cc64dd72e548f89a","name":"json to string","property":"payload","action":"str","pretty":false,"x":755.5555648803711,"y":248.88890075683594,"wires":[["c1cc3cceb3fe9e59"]]},{"id":"862b5f4e2026532f","type":"function","z":"cc64dd72e548f89a","name":"function 6","func":"const parsedData = JSON.parse(msg.payload);\nconst value = parsedData.value;\nmsg.payload=value\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1131.1110916137695,"y":243.3333282470703,"wires":[["bea6ac6d48e00268"]]},{"id":"f4c0839d5174e82e","type":"http request","z":"cc64dd72e548f89a","name":"[https] Fan get key-value","method":"POST","ret":"txt","paytoqs":"ignore","url":"https://api.anedya.io/v1/valuestore/getValue","tls":"","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"","senderr":false,"headers":[{"keyType":"Authorization","keyValue":"","valueType":"other","valueValue":"Bearer c93b7fdbcb11a189e8f33a89d1bfa56f92836d5ed3c148ec9bf912f29a9abee5"},{"keyType":"Accept","keyValue":"","valueType":"application/json","valueValue":""}],"x":930,"y":440,"wires":[["ba1e425263033308"]]},{"id":"d36f93173f4aca0d","type":"json","z":"cc64dd72e548f89a","name":"json to string","property":"payload","action":"str","pretty":false,"x":710,"y":440,"wires":[["f4c0839d5174e82e"]]},{"id":"ba1e425263033308","type":"function","z":"cc64dd72e548f89a","name":"function 7","func":"const parsedData = JSON.parse(msg.payload);\nconst value = parsedData.value;\nmsg.payload=value\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1120,"y":440,"wires":[["ad94c98b4df40846"]]},{"id":"25b149d370343765","type":"template","z":"cc64dd72e548f89a","name":"light_payload","field":"payload","fieldType":"msg","format":"json","syntax":"mustache","template":"{\n  \"namespace\": {\n    \"scope\": \"node\",\n    \"id\": \"20deeee8-f8ae-11ee-9dd8-c3aa61afe2fb\"\n  },\n  \"key\": \"Fan\"\n}","output":"json","x":550,"y":440,"wires":[["d36f93173f4aca0d"]]},{"id":"6734ac4e428c0a40","type":"inject","z":"cc64dd72e548f89a","name":"Sync Fan state","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"2","crontab":"","once":true,"onceDelay":"1","topic":"","payload":"","payloadType":"date","x":500,"y":400,"wires":[["25b149d370343765"]]},{"id":"a6ee086ccbece116","type":"function","z":"cc64dd72e548f89a","name":"function 8","func":"var payloadJson\nif(msg.payload){\n    payloadJson={\n  \"namespace\": {\n    \"scope\": \"node\",\n    \"id\": \"20deeee8-f8ae-11ee-9dd8-c3aa61afe2fb\"\n  },\n  \"key\": \"Light\",\n  \"value\": true,\n  \"type\": \"boolean\"\n}\n    }else{\n        payloadJson={\n  \"namespace\": {\n    \"scope\": \"node\",\n    \"id\": \"20deeee8-f8ae-11ee-9dd8-c3aa61afe2fb\"\n  },\n  \"key\": \"Light\",\n  \"value\": false,\n  \"type\": \"boolean\"\n}\n    }\n\nvar jsonStr=JSON.stringify(payloadJson);\nmsg.payload=jsonStr\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1451.1110916137695,"y":223.3333282470703,"wires":[["720a217c81844fa0"]]},{"id":"720a217c81844fa0","type":"http request","z":"cc64dd72e548f89a","name":"[https] Light set key-value","method":"POST","ret":"txt","paytoqs":"ignore","url":"https://api.anedya.io/v1/valuestore/setValue","tls":"","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"","senderr":false,"headers":[{"keyType":"Authorization","keyValue":"","valueType":"other","valueValue":"Bearer c93b7fdbcb11a189e8f33a89d1bfa56f92836d5ed3c148ec9bf912f29a9abee5"},{"keyType":"Accept","keyValue":"","valueType":"application/json","valueValue":""}],"x":1661.1110916137695,"y":223.3333282470703,"wires":[[]]},{"id":"872da5f7bf30417e","type":"debug","z":"cc64dd72e548f89a","name":"debug 10","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1860,"y":480,"wires":[]},{"id":"d6e7d150dec0fda8","type":"http request","z":"cc64dd72e548f89a","name":"[https] Fan set key-value","method":"POST","ret":"txt","paytoqs":"ignore","url":"https://api.anedya.io/v1/valuestore/setValue","tls":"","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"","senderr":false,"headers":[{"keyType":"Authorization","keyValue":"","valueType":"other","valueValue":"Bearer c93b7fdbcb11a189e8f33a89d1bfa56f92836d5ed3c148ec9bf912f29a9abee5"},{"keyType":"Accept","keyValue":"","valueType":"application/json","valueValue":""}],"x":1670,"y":480,"wires":[["872da5f7bf30417e"]]},{"id":"ead59d17cfacd9ba","type":"function","z":"cc64dd72e548f89a","name":"function 9","func":"let payloadJson\nif(msg.payload){\n    payloadJson={\n  \"namespace\": {\n    \"scope\": \"node\",\n    \"id\": \"20deeee8-f8ae-11ee-9dd8-c3aa61afe2fb\"\n  },\n  \"key\": \"Fan\",\n  \"value\": true,\n  \"type\": \"boolean\"\n}\n    }else{\n       payloadJson={\n  \"namespace\": {\n    \"scope\": \"node\",\n    \"id\": \"20deeee8-f8ae-11ee-9dd8-c3aa61afe2fb\"\n  },\n  \"key\": \"Fan\",\n  \"value\": false,\n  \"type\": \"boolean\"\n}\n    }\n\nvar jsonStr=JSON.stringify(payloadJson);\nmsg.payload=jsonStr\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1460,"y":480,"wires":[["d6e7d150dec0fda8"]]},{"id":"1e87bd738548db3d","type":"function","z":"cc64dd72e548f89a","d":true,"name":"function 10","func":"var apiKey=global.get(\"apiKey\")\nvar apiKey_in_formate=\"Bearer \"+apiKey\nmsg.apiKey=apiKey_in_formate\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":710,"y":660,"wires":[["59c9683ac1cecc4b"]]},{"id":"cbbdadd3f8e2a6cd","type":"change","z":"cc64dd72e548f89a","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":860,"y":600,"wires":[[]]},{"id":"c9d4c5a6e586d66f","type":"function","z":"cc64dd72e548f89a","d":true,"name":"function 11","func":"var apiKey=global.get(\"apiKey\")\nvar apiKey_in_formate=\"Bearer \"+apiKey\nmsg.apiKey=apiKey_in_formate\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":735.5556030273438,"y":1037.7778315544128,"wires":[["5ac3453baed4a0e7"]]},{"id":"a5bd275360fc329d","type":"debug","z":"cc64dd72e548f89a","name":"debug 14","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":1460,"y":540,"wires":[]},{"id":"ddf319c5cbe6d777","type":"ui-button","z":"cc64dd72e548f89a","group":"ad25646ff154522b","name":"Node-editor","label":"Node Editor","order":1,"width":"2","height":"1","emulateClick":false,"tooltip":"","color":"","bgcolor":"","className":"","icon":"","iconPosition":"left","payload":"","payloadType":"str","topic":"topic","topicType":"msg","buttonColor":"","textColor":"","iconColor":"","x":1990,"y":180,"wires":[[]]},{"id":"c7d57b62287d0c5e","type":"inject","z":"cc64dd72e548f89a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"2","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":522.2221984863281,"y":1227.7777919769287,"wires":[["8306ea98ca43c81f"]]},{"id":"8306ea98ca43c81f","type":"function","z":"cc64dd72e548f89a","name":"function 12","func":"let a = Math.floor(Math.random() * 101); // generate a random number between 0 and 100\nmsg.payload = 100;\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":722.2221984863281,"y":1247.7777919769287,"wires":[["9d2f136ecb5b78e0","426dac5b5175c659"]]},{"id":"9d2f136ecb5b78e0","type":"debug","z":"cc64dd72e548f89a","name":"debug 15","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":952.2221984863281,"y":1327.7777919769287,"wires":[]},{"id":"426dac5b5175c659","type":"ui-gauge","z":"cc64dd72e548f89a","name":"Battery Level","group":"cc9daaeac75086db","order":2,"width":"2","height":"2","gtype":"gauge-battery","gstyle":"needle","title":"","units":"units","icon":"","prefix":"","suffix":"","segments":[{"from":"0","color":"#ea5353"},{"from":"40","color":"#ffc800"},{"from":"70","color":"#5cd65c"}],"min":0,"max":"100","sizeThickness":16,"sizeGap":4,"sizeKeyThickness":8,"styleRounded":true,"styleGlow":false,"className":"","x":982.2221984863281,"y":1247.7777919769287,"wires":[]},{"id":"56ae927ead86b0dd","type":"ui-gauge","z":"cc64dd72e548f89a","name":"","group":"cc9daaeac75086db","order":1,"width":"2","height":"1","gtype":"gauge-tile","gstyle":"needle","title":"","units":"units","icon":"","prefix":"","suffix":"","segments":[{"from":"0","color":"#ff0000"},{"from":"1","color":"#5cd65c"}],"min":0,"max":"1","sizeThickness":16,"sizeGap":4,"sizeKeyThickness":8,"styleRounded":true,"styleGlow":false,"className":"","x":751.6666488647461,"y":884.4444255828857,"wires":[]},{"id":"7e3688c7bec48eda","type":"ui-switch","z":"cc64dd72e548f89a","name":"","label":"switch","group":"","order":2,"width":0,"height":0,"passthru":false,"decouple":false,"topic":"topic","topicType":"msg","style":"","className":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":521.6666488647461,"y":844.4444255828857,"wires":[["aa83451298fc2e81","56ae927ead86b0dd","209cf70215ee9234"]]},{"id":"209cf70215ee9234","type":"function","z":"cc64dd72e548f89a","name":"function 14","func":"if (msg.payload) {\n    // To enable group\n    msg.payload = {\n        groups: {\n            enable: ['Home:Current Temperature','Home:Current Humidity','Home:Controls','Home:Temperature Chart','Home:Humidity chart',]\n        }\n    };\n\n}\nelse {\n    // To disable group\n    msg.payload = {\n        groups: {\n            disable: ['Home:Current Temperature','Home:Current Humidity','Home:Controls','Home:Temperature Chart','Home:Humidity chart',]\n        }\n    };\n\n}\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":761.666633605957,"y":933.3333415985107,"wires":[["90da610bb599f318"]]},{"id":"90da610bb599f318","type":"ui-control","z":"cc64dd72e548f89a","name":"","ui":"2a4cccc1f2ec666f","events":"connect","x":920,"y":880,"wires":[[]]},{"id":"aa83451298fc2e81","type":"debug","z":"cc64dd72e548f89a","name":"debug 16","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":751.6666488647461,"y":844.4444255828857,"wires":[]},{"id":"6f4e0351336dd2cd","type":"function","z":"cc64dd72e548f89a","name":"function 15","func":"const parsedData = JSON.parse(msg.payload);\nconst value = parsedData.data[0].value;\n\nmsg.payload = value;\n\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1115.5556030273438,"y":1117.7778315544128,"wires":[["4374941834cd5278","542ee6e44901b351","7179195eaf859061"]]},{"id":"7075051f1553a703","type":"inject","z":"cc64dd72e548f89a","name":"get_latest_data_payload","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"240","crontab":"","once":false,"onceDelay":"1","topic":"","payload":"{\"nodes\":[\"20deeee8-f8ae-11ee-9dd8-c3aa61afe2fb\"],\"variable\":\"deviceLiveStatus\"}","payloadType":"json","x":115,"y":873.333324432373,"wires":[["103034258cbe9adc"]]},{"id":"103034258cbe9adc","type":"http request","z":"cc64dd72e548f89a","name":"get_latest_data","method":"POST","ret":"txt","paytoqs":"ignore","url":"https://api.anedya.io/v1/data/latest","tls":"","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"","senderr":false,"headers":[{"keyType":"Authorization","keyValue":"","valueType":"other","valueValue":"Bearer c93b7fdbcb11a189e8f33a89d1bfa56f92836d5ed3c148ec9bf912f29a9abee5"},{"keyType":"Accept","keyValue":"","valueType":"application/json","valueValue":""}],"x":345,"y":873.333324432373,"wires":[["599d0d1c4ff58cf6"]]},{"id":"599d0d1c4ff58cf6","type":"function","z":"cc64dd72e548f89a","name":"function 16","func":"const parsedData = JSON.parse(msg.payload);\nconst value = parsedData.data[0].value;\nlet current_deviceLiveTimestamp = parsedData.data[0].timestamp;\nlet current_time = Math.floor(Date.now() / 1000);\nif ((current_time - current_deviceLiveTimestamp ) < 600) {\n    msg.payload = 1;\n    msg.deviceLiveStatus=1;\n}else{\n    msg.payload = 0;\n    msg.deviceLiveStatus=0;\n}\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":515,"y":893.333324432373,"wires":[["aa83451298fc2e81","56ae927ead86b0dd","209cf70215ee9234"]]},{"id":"3b77ceb72c380e2e","type":"debug","z":"24e1411905e488b9","name":"debug 13","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":900,"y":120,"wires":[]},{"id":"1b2f80745ba30142","type":"ui-form","z":"24e1411905e488b9","name":"Anedya connection credentials","group":"65d2902c5e05e02c","label":"","order":1,"width":"3","height":"1","options":[{"label":"Node Id","key":"nodeId","type":"text","required":true,"rows":null},{"label":"Api key","key":"apiKey","type":"text","required":true,"rows":null}],"formValue":{"nodeId":"","apiKey":""},"payload":"","submit":"Set","cancel":"clear","resetOnSubmit":false,"topic":"topic","topicType":"msg","splitLayout":false,"className":"","passthru":false,"x":370,"y":120,"wires":[["c2e2d15e0820f94d"]]},{"id":"c2e2d15e0820f94d","type":"function","z":"24e1411905e488b9","name":"func to set the nodeId and apiKey","func":"let form_data=msg.payload\nlet nodeId=form_data.nodeId\nlet apiKey=form_data.apiKey\nglobal.set(\"nodeId\",nodeId)\nglobal.set(\"apiKey\",apiKey)\nlet get_nodeId=global.get(\"nodeId\")\nlet get_apiKey=global.get(\"apiKey\")\nlet json_payload={\n    \"node_id\":get_nodeId,\n    \"api_key\":get_apiKey\n}\nmsg.payload=JSON.stringify(json_payload);\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":680,"y":120,"wires":[["3b77ceb72c380e2e"]]},{"id":"2932098ed8720f05","type":"inject","z":"24e1411905e488b9","name":"Set Global Var","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1320,"y":120,"wires":[["b626d49dbc2dbd96"]]},{"id":"b626d49dbc2dbd96","type":"function","z":"24e1411905e488b9","name":"Set Global Var","func":"global.set(\"humLastFetchDataTimesatamp\",0);\nglobal.set(\"tempLastFetchDataTimesatamp\",0);\nglobal.set(\"last_deviceLiveTimestamp\",0);\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1560,"y":120,"wires":[[]]},{"id":"4a0b67861a64ee85","type":"ui-template","z":"7bef6a87fd115472","group":"","page":"91ca877ba92392b8","ui":"","name":"","order":2,"width":0,"height":0,"head":"","format":"<style>\n  .my-custom-class {\n    //background-color: #4CAF50; /* Green background */\n    //color: white; /* White text */\n    //border-radius: 5px; /* Rounded corners */\n    // margin-top:0;\n    // padding-top:0;\n    height: 15rem;\n    margin-bottom: 4rem;\n\n  }\n\n  .custom-gauge-css {\n    padding-top: 2rem;\n    margin-bottom: 3rem;\n  }\n\n  .branding-custom-class {\n    height: 16.3rem;\n    padding:0;\n    margin:0;\n    //padding-bottom: 2rem;\n\n  }\n</style>","storeOutMessages":true,"passthru":true,"resendOnRefresh":true,"templateScope":"widget:page","className":"","x":160,"y":80,"wires":[[]]},{"id":"4f8cba114f31fb56","type":"ui-template","z":"7bef6a87fd115472","group":"7da969187e283dbb","page":"","ui":"","name":"","order":1,"width":"4","height":"2","head":"","format":"<div style=\"text-align: center; padding: 10px; background-color: #f8f9fa; border-bottom: 2px solid #007bff;\">\n    <img src=\"https://camo.githubusercontent.com/7fe4add0cee620cc1ffae9271086ec2a56e1263d39ff9652106504a1cf437c98/68747470733a2f2f63646e2e616e656479612e696f2f616e656479615f626c61636b5f62616e6e65722e706e67\" alt=\"Company Logo\" style=\"height: 80px;\">\n    <h1 style=\"color: #007bff;\"> Anedya </h1>\n    <p style=\"font-size: 18px; color: #555; margin-bottom:0; padding-bottom:0;\">One Stop, IoT Cloud!</p>\n</div>\n\n<style>\n    /* Custom styles for branding */\n    body {\n        font-family: Arial, sans-serif;\n    }\n    h1 {\n        margin: 5px 0;\n    }\n    p {\n        margin: 2px 0;\n    }\n</style>","storeOutMessages":true,"passthru":true,"resendOnRefresh":true,"templateScope":"local","className":"branding-custom-class","x":160,"y":140,"wires":[[]]}]